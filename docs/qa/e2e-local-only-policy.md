# E2E测试本地专用策略

## 概述

本文档规定了E2E（端到端）测试用例的使用策略，确保E2E测试仅用于本地开发环境，不进入CI/CD流程。

## 策略规定

### ✅ **允许使用场景**

1. **本地开发环境**
   - 开发者本地验证完整用户流程
   - 本地调试和问题排查
   - 本地功能验证

2. **本地测试命令**
   ```bash
   npm run test:e2e:local
   ```

### ❌ **禁止使用场景**

1. **CI/CD流程**
   - GitHub Actions
   - 自动化测试流水线
   - 持续集成环境

2. **生产环境**
   - 生产部署验证
   - 生产环境测试

## 技术实现

### 1. E2E测试隔离

- **文件位置**: `tests/e2e-config-flow.test.js`
- **运行脚本**: `tests/run-local-e2e-tests.js`
- **npm命令**: `npm run test:e2e:local`

### 2. CI配置排除

- **CI配置文件**: `.github/workflows/ci.yml`
- **排除策略**: CI中不包含E2E测试
- **综合测试**: `tests/run-comprehensive-tests.js` 中已注释E2E测试

### 3. 测试分类

```javascript
// 本地专用E2E测试
const e2eTestConfig = {
  testFiles: [
    'tests/e2e-config-flow.test.js'
  ],
  environment: 'local-only'
};
```

## 使用指南

### 开发者本地使用

1. **运行E2E测试**
   ```bash
   npm run test:e2e:local
   ```

2. **验证完整流程**
   - 配置流程测试
   - 用户交互测试
   - 端到端功能验证

### CI/CD流程

1. **CI测试范围**
   - 单元测试 ✅
   - 集成测试 ✅
   - 静态代码检查 ✅
   - E2E测试 ❌ (已排除)

2. **质量门禁**
   - 不依赖E2E测试结果
   - 基于单元测试和集成测试

## 监控和验证

### 1. 定期检查

- 确保CI配置不包含E2E测试
- 验证本地E2E测试功能正常
- 检查测试隔离是否有效

### 2. 文档更新

- 保持策略文档最新
- 更新使用指南
- 记录变更历史

## 违规处理

### 1. 发现E2E测试进入CI

- 立即从CI配置中移除
- 检查相关配置文件
- 更新测试策略

### 2. 预防措施

- 代码审查时检查CI配置
- 定期审计测试流程
- 建立监控机制

## 总结

E2E测试仅用于本地开发环境，不进入CI/CD流程。通过技术隔离和策略规定，确保测试流程的合理性和效率。

---

**最后更新**: 2024-10-06  
**负责人**: Product Owner  
**状态**: 已实施
