# Test Design: Story E1.S1

Date: 2025-09-19
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 6
- Unit tests: 3 (50%)
- Integration tests: 1 (17%)
- E2E tests: 2 (33%)
- Priority distribution: P0: 3, P1: 3, P2: 0

## Test Scenarios by Acceptance Criteria

### AC1: 单入口菜单根据场景动态展示互斥动作

| ID             | Level | Priority | Test 描述                                             | Justification                                             | Mitigates |
|----------------|-------|----------|------------------------------------------------------|-----------------------------------------------------------|-----------|
| E1.S1-UNIT-001 | unit  | P0       | 验证 `resolveMenuContext` 在新选区返回 add 场景        | 纯函数逻辑，适合在单元测试层验证                          | TECH-001 |
| E1.S1-UNIT-002 | unit  | P0       | 验证 `resolveMenuContext` 在已翻译选区返回 remove 场景 | 同上，聚焦纯逻辑                                           | TECH-002 |
| E1.S1-INT-001  | int   | P1       | 模拟 onShown→onClicked 流程，确认缓存动作执行正确      | 涉及 chrome stub 与菜单状态缓存，需集成测试                | TECH-002 |

### AC2: 页面翻译开关与 tab 状态互斥切换

| ID             | Level | Priority | Test 描述                                             | Justification                                             | Mitigates |
|----------------|-------|----------|------------------------------------------------------|-----------------------------------------------------------|-----------|
| E1.S1-UNIT-003 | unit  | P0       | 验证 `handleTogglePage` 根据 tab 状态切换 TRANSLATE/RESET | 逻辑主要操作 storage/session，单元级可控                  | TECH-001 |
| E1.S1-E2E-001  | e2e   | P1       | 在真实 Chrome 中测试启停翻译并验证菜单文案刷新         | 覆盖用户关键路径，佐证操作反馈 ≤500ms 要求                 | TECH-001 |

### AC3: 添加/移除词条即时生效并同步通知

| ID             | Level | Priority | Test 描述                                             | Justification                                             | Mitigates |
|----------------|-------|----------|------------------------------------------------------|-----------------------------------------------------------|-----------|
| E1.S1-E2E-002  | e2e   | P1       | 全流程：添加新词、移除已翻译词、验证通知与页面效果     | 需要端到端观察 content script 与 background 协作            | OPS-001  |

## Risk Coverage

- TECH-001: E1.S1-UNIT-001, E1.S1-UNIT-003, E1.S1-E2E-001
- TECH-002: E1.S1-UNIT-002, E1.S1-INT-001
- OPS-001: E1.S1-E2E-002

## Recommended Execution Order

1. P0 单元测试（E1.S1-UNIT-001/002/003）
2. P1 集成测试（E1.S1-INT-001）
3. P1 端到端测试（E1.S1-E2E-001 → E1.S1-E2E-002）

Test design matrix: docs/qa/assessments/e1.s1-test-design-20250919.md
P0 tests identified: 3
